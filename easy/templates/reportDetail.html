<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    {% load static %}
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">

    <link rel="stylesheet" href="{% static 'layui2.5.5/css/layui.css' %}">
    <link rel="stylesheet" href="{% static 'font-awesome-4.7.0/css/font-awesome.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/soulTable.css' %}">
    <link rel="stylesheet" href="{% static 'css/reportDetail.css' %}">

    <script src="http://cdn.highcharts.com.cn/highcharts/highcharts.js"></script>
    <script src="https://code.highcharts.com.cn/highcharts/themes/grid-light.js"></script>
    <script src="{% static 'jquery-3.4.1/jquery-3.4.1.min.js' %}" type="text/javascript"></script>
    <script src="{% static 'js/echarts.min.js' %}" type="text/javascript"></script>
    <script src="{% static 'layui2.5.5/layui.js' %}"></script>
    <script>
        var parentId = '{{ parentId }}';
    </script>
    <script src="{% static 'js/reportDetail.js' %}"></script>
</head>

<body>

<div>
    <!--树加滚动条overflow: scroll;-->
    <div class="zzh">
        <!--树-->
        <div class="report">
            <div id="highcases" style="min-width:400px;height:250px;;margin-right: 200px;float: right;"></div>
            <div id="highcaseset" style="min-width:400px;height:250px;"></div>
        </div>
        <div class="return"><a class="layui-btn layui-btn-sm" href="/interface_test_report">返回上一级</a></div>
        <div id="test" class="demo-tree demo-tree-box treetable"></div>
        <div class="treetable mytable">
            <!--表格-->
            <table id="treetable" lay-filter="treetable"></table>
        </div>
    </div>
</div>


{#表头按钮#}
<script type="text/html" id="toolbarDemo">
    <div class="layui-btn-container">
        <button class="layui-btn layui-btn-sm" lay-event="export_report">导出图表</button>
    </div>
</script>

<script>
// 绘制图表。
$(function () {
    $.ajax({
        url: "/api/v1/report_detail/echarts/",
        type: 'GET',
        data: {
            "parentId": parentId,
            "id": "caseset"
        },
        //请求前的处理,加载loading
        success: function (data) {
            console.log(data);
            Highcharts.chart('highcaseset', {
                chart: {
                    plotBackgroundColor: null,
                    plotBorderWidth: null,
                    plotShadow: false,
                    type: 'pie'
                },
                title: {
                    text: '用例集数据统计'
                },
                tooltip: {
                    pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
                },
                plotOptions: {
                    pie: {
                        allowPointSelect: true,
                        cursor: 'pointer',
                        dataLabels: {
                            enabled: true,
                            format: '<b>{point.name}</b>: {point.percentage:.1f} %',
                            style: {
                                color: (Highcharts.theme && Highcharts.theme.contrastTextColor) || 'black'
                            }
                        },
                        showInLegend: true
                    }
                },
                series: [{
                    name: '用例集',
                    colorByPoint: true,
                    data: data
                }]
            });
        },
        error: function (data) {
            console.log(data);
            alert("出错了，请查看控制台！")

        }
    });
    $.ajax({
        url: "/api/v1/report_detail/echarts/",
        type: 'GET',
        data: {
            "parentId": parentId,
            "id": "cases"
        },
        //请求前的处理,加载loading
        success: function (data) {
            console.log(data);
            Highcharts.chart('highcases', {
                chart: {
                    plotBackgroundColor: null,
                    plotBorderWidth: null,
                    plotShadow: false,
                    type: 'pie'
                },
                title: {
                    text: '用例数据统计'
                },
                tooltip: {
                    pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
                },
                plotOptions: {
                    pie: {
                        allowPointSelect: true,
                        cursor: 'pointer',
                        size:"100%",
                        dataLabels: {
                            enabled: true,
                            format: '<b>{point.name}</b>: {point.percentage:.1f} %',
                            style: {
                                color: (Highcharts.theme && Highcharts.theme.contrastTextColor) || 'black'
                            }
                        },
                        showInLegend: true
                    }
                },
                series: [{
                    name: '用例',
                    colorByPoint: true,
                    data: data
                }]
            });
        },
        error: function (data) {
            console.log(data);
            alert("出错了，请查看控制台！")

        }
    });
})
</script>


</body>

</html>